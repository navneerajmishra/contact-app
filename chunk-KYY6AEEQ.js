import{Aa as L,Ca as J,Db as N,Eb as l,Fb as F,Ma as G,Mb as rt,P as j,Qa as Q,S as z,V as m,Wa as X,Xa as Y,Za as T,_a as Z,a as s,b as h,c as S,cb as tt,db as et,eb as nt,ha as V,ib as _,lb as it,mb as ot,na as C,pa as H,q as w,qa as K,r as E}from"./chunk-O7LGMGVH.js";function xt(t,e){if(t&1&&nt(0,"img",2),t&2){let i=_();T("",i.size()," rounded-full"),Y("src",i.imageUrl(),L)("alt",i.name()?i.name():"User avatar")}}function bt(t,e){if(t&1&&(tt(0,"div",3)(1,"span",4),it(2),et()()),t&2){let i=_();T("relative inline-flex items-center justify-center ",i.size()," overflow-hidden bg-gray-100 rounded-full"),X("aria-label",i.name()?i.name():"User avatar"),J(2),ot(i.initials())}}var $t=(()=>{class t{constructor(){this.name=C(),this.imageUrl=C(),this.size=C("sm"),this.isValidImage=K(!1),this.initials=l(()=>this.name()?.split(" ").reduce((i,n)=>(i??"").concat(n.charAt(0)),"")),F(()=>{let i=this.imageUrl();if(!i){this.isValidImage.set(!1);return}let n=new Image;n.onload=()=>this.isValidImage.set(!0),n.onerror=()=>this.isValidImage.set(!1),n.src=i})}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=G({type:t,selectors:[["ca-avatar"]],inputs:{name:[1,"name"],imageUrl:[1,"imageUrl"],size:[1,"size"]},decls:2,vars:1,consts:[["role","img",3,"class","src","alt"],["role","img",3,"class"],["role","img",3,"src","alt"],["role","img"],[1,"font-medium","text-gray-600"]],template:function(n,o){n&1&&Q(0,xt,1,5,"img",0)(1,bt,3,5,"div",1),n&2&&Z(o.isValidImage()?0:1)},encapsulation:2})}}return t})();function ct(t){let e=N(()=>t());return Ct(e)?new Proxy(t,{get(i,n){return n in e?(H(i[n])||Object.defineProperty(i,n,{value:l(()=>i()[n]),configurable:!0}),ct(i[n])):i[n]}}):t}var jt=[WeakSet,WeakMap,Promise,Date,Error,RegExp,ArrayBuffer,DataView,Function];function Ct(t){if(t===null||typeof t!="object"||Kt(t))return!1;let e=Object.getPrototypeOf(t);if(e===Object.prototype)return!0;for(;e&&e!==Object.prototype;){if(jt.includes(e.constructor))return!1;e=Object.getPrototypeOf(e)}return e===Object.prototype}function Kt(t){return typeof t?.[Symbol.iterator]=="function"}var At=new WeakMap,d=Symbol("STATE_SOURCE");function f(t,...e){t[d].update(i=>e.reduce((n,o)=>s(s({},n),typeof o=="function"?o(n):o),i)),kt(t)}function Rt(t){return t[d]()}function Ut(t){return At.get(t[d])||[]}function kt(t){let e=Ut(t);for(let i of e){let n=N(()=>Rt(t));i(n)}}function at(...t){let e=[...t],i=typeof e[0]=="function"?{}:e.shift(),n=e;return(()=>{class r{constructor(){let a=n.reduce((b,vt)=>vt(b),Dt()),{stateSignals:y,props:D,methods:M,hooks:It}=a,q=s(s(s({},y),D),M);this[d]=a[d];for(let b of Reflect.ownKeys(q))this[b]=q[b];let{onInit:W,onDestroy:$}=It;W&&W(),$&&m(V).onDestroy($)}static \u0275fac=function(y){return new(y||r)};static \u0275prov=j({token:r,factory:r.\u0275fac,providedIn:i.providedIn||null})}return r})()}function Dt(){return{[d]:K({}),stateSignals:{},props:{},methods:{},hooks:{}}}function A(t,...e){let i=typeof t=="function"?[t,...e]:e;return n=>i.reduce((o,r)=>r(o),n)}function Tt(t){return e=>{let i=t(s(s(s({[d]:e[d]},e.stateSignals),e.props),e.methods));return Reflect.ownKeys(i),h(s({},e),{props:s(s({},e.props),i)})}}function R(t){return Tt(t)}function ut(t){return e=>{let i=s(s(s({[d]:e[d]},e.stateSignals),e.props),e.methods),n=typeof t=="function"?t(i):t,o=r=>{let c=n[r],a=e.hooks[r];return c?()=>{a&&a(),c(i)}:a};return h(s({},e),{hooks:{onInit:o("onInit"),onDestroy:o("onDestroy")}})}}function dt(t){return e=>{let i=t(s(s(s({[d]:e[d]},e.stateSignals),e.props),e.methods));return Reflect.ownKeys(i),h(s({},e),{methods:s(s({},e.methods),i)})}}function U(t){return e=>{let i=typeof t=="function"?t():t,n=Reflect.ownKeys(i);e[d].update(r=>s(s({},r),i));let o=n.reduce((r,c)=>{let a=l(()=>e[d]()[c]);return h(s({},r),{[c]:ct(a)})},{});return h(s({},e),{stateSignals:s(s({},e.stateSignals),o)})}}var u=function(t){return t[t.None=0]="None",t[t.Entities=1]="Entities",t[t.Both=2]="Both",t}(u||{}),_t=t=>t.id;function k(t){return t?.selectId??_t}function g(t){let e=t?.collection,i=e===void 0?"entityMap":`${e}EntityMap`,n=e===void 0?"ids":`${e}Ids`,o=e===void 0?"entities":`${e}Entities`;return{entityMapKey:i,idsKey:n,entitiesKey:o}}function I(t,e){return{entityMap:s({},t[e.entityMapKey]),ids:[...t[e.idsKey]]}}function v(t,e,i){switch(i){case u.Both:return{[e.entityMapKey]:t.entityMap,[e.idsKey]:t.ids};case u.Entities:return{[e.entityMapKey]:t.entityMap};default:return{}}}function lt(t,e,i,n=!1){let o=i(e);return t.entityMap[o]?u.None:(t.entityMap[o]=e,n?t.ids.unshift(o):t.ids.push(o),u.Both)}function Nt(t,e,i,n=!1){let o=u.None;for(let r of e){let c=lt(t,r,i,n);c===u.Both&&(o=c)}return o}function Ft(t,e,i,n=!0){let o=i(e);return t.entityMap[o]?(t.entityMap[o]=n?e:s(s({},t.entityMap[o]),e),u.Entities):(t.entityMap[o]=e,t.ids.push(o),u.Both)}function Ot(t,e){let i=Array.isArray(e)?e:t.ids.filter(o=>e(t.entityMap[o])),n=u.None;for(let o of i)t.entityMap[o]&&(delete t.entityMap[o],n=u.Both);return n===u.Both&&(t.ids=t.ids.filter(o=>o in t.entityMap)),n}function Bt(t,e,i,n){let o=Array.isArray(e)?e:t.ids.filter(a=>e(t.entityMap[a])),r,c=u.None;for(let a of o){let y=t.entityMap[a];if(y){let D=typeof i=="function"?i(y):i;t.entityMap[a]=s(s({},y),D),c=u.Entities;let M=n(t.entityMap[a]);M!==a&&(t.entityMap[M]=t.entityMap[a],delete t.entityMap[a],r=r||{},r[a]=M)}}return r&&(t.ids=t.ids.map(a=>r[a]??a),c=u.Both),c}function O(t,e){let i=k(e),n=g(e);return o=>{let r=I(o,n),c=lt(r,t,i);return v(r,n,c)}}function ft(t,e){let i=k(e),n=g(e);return o=>{let r=I(o,n),c=Nt(r,t,i);return v(r,n,c)}}function pt(t,e){let i=g(e);return n=>{let o=I(n,i),r=Ot(o,[t]);return v(o,i,r)}}function yt(t,e){let i=k(e),n=g(e);return o=>{let r=I(o,n),c=Bt(r,[t.id],t.changes,i);return v(r,n,c)}}function B(t,e){let i=k(e),n=g(e);return o=>{let r=I(o,n),c=Ft(r,t,i,!1);return v(r,n,c)}}function mt(t){let{entityMapKey:e,idsKey:i,entitiesKey:n}=g(t);return A(U({[e]:{},[i]:[]}),R(o=>({[n]:l(()=>{let r=o[e]();return o[i]().map(a=>r[a])})})))}var ht=new z("API URL");var x=t=>({id:t.id,firstName:t.first_name,lastName:t.last_name,email:t.email,company:t.company,jobTitle:t.job_title,createdOn:t.created_on,phone:Pt(t.phone),avatar:t.avatar}),gt=t=>({id:t.id,first_name:t.firstName,last_name:t.lastName,email:t.email,company:t.company,job_title:t.jobTitle,created_on:t.createdOn,phone:`${t.phone.number}${t.phone.extension?" x"+t.phone.extension:""}`,avatar:t.avatar}),Pt=t=>{let[e,i]=t?.split("x");return{number:(e??"").trim(),extension:(i??"").trim()}};var Mt=(()=>{class t{#t=m(rt);#e=m(ht);getAllContacts(){return this.#t.get(this.#e).pipe(E(i=>i.map(n=>x(n))))}deleteContact(i){return this.#t.delete(`${this.#e}/${i}`).pipe(E(n=>x(n)))}createOrUpdateContact(i){let n=gt(i);return i.id?this.#i(i.id,n):this.#n(n)}#n(i){return this.#t.post(this.#e,JSON.stringify(i)).pipe(E(n=>x(n)))}#i(i,n){return this.#t.put(`${this.#e}/${i}`,JSON.stringify(n)).pipe(E(o=>x(o)))}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275prov=j({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function St(){return{requestStatus:"pending"}}function wt(){return{requestStatus:"fulfilled"}}function P(t){return{requestStatus:{error:t}}}function Et(){return A(U({requestStatus:"idle"}),R(({requestStatus:t})=>({isPending:l(()=>t()==="pending"),isFulfilled:l(()=>t()==="fulfilled"),error:l(()=>{let e=t();return typeof e=="object"?e.error:null})})))}var p={entity:void 0,collection:"contact",selectId:t=>t.id},Ie=at({providedIn:"root"},mt(p),Et(),dt((t,e=m(Mt))=>({loadAll(){return S(this,null,function*(){f(t,St());let n=yield w(e.getAllContacts());f(t,ft(n,p),wt())})},create(n){return S(this,null,function*(){if(!n)throw new Error("Contact is required");try{let o=yield w(e.createOrUpdateContact(n));f(t,O(o,p))}catch(o){throw f(t,P("Failed to create contact")),o}})},optimisticUpdate(n,o){return S(this,null,function*(){if(!o||!n)throw new Error("Contact is required");let r=t.contactEntityMap()[n];f(t,B(o,p));try{let c=yield w(e.createOrUpdateContact(o));f(t,B(c,p))}catch(c){throw f(t,yt({id:n,changes:r},p),P("Failed to update contact")),c}})},optimisticDelete(n){return S(this,null,function*(){if(!n)throw new Error("Contact ID is required");let o=t.contactEntityMap()[n];f(t,pt(n,p));try{yield w(e.deleteContact(n))}catch(r){throw f(t,O(o,p)),r}})}})),ut({onInit({loadAll:t}){t()}}));export{$t as a,ht as b,Ie as c};
