import{Hb as B,Jb as T,P as M,V as l,a as i,b as f,c as x,d as C,ga as A,oa as D,pa as N,r as R,s as k,xb as w,yb as d}from"./chunk-ANTMNTRI.js";function P(t){let e=w(()=>t());return Z(e)?new Proxy(t,{get(n,o){return o in e?(D(n[o])||Object.defineProperty(n,o,{value:d(()=>n()[o]),configurable:!0}),P(n[o])):n[o]}}):t}var Y=[WeakSet,WeakMap,Promise,Date,Error,RegExp,ArrayBuffer,DataView,Function];function Z(t){if(t===null||typeof t!="object"||_(t))return!1;let e=Object.getPrototypeOf(t);if(e===Object.prototype)return!0;for(;e&&e!==Object.prototype;){if(Y.includes(e.constructor))return!1;e=Object.getPrototypeOf(e)}return e===Object.prototype}function _(t){return typeof t?.[Symbol.iterator]=="function"}var tt=new WeakMap,c=Symbol("STATE_SOURCE");function I(t,...e){t[c].update(n=>e.reduce((o,r)=>i(i({},o),typeof r=="function"?r(o):r),n)),ot(t)}function et(t){return t[c]()}function nt(t){return tt.get(t[c])||[]}function ot(t){let e=nt(t);for(let n of e){let o=w(()=>et(t));n(o)}}function F(...t){let e=[...t],n=typeof e[0]=="function"?{}:e.shift(),o=e;return(()=>{class s{constructor(){let a=o.reduce((m,Q)=>Q(m),it()),{stateSignals:y,props:b,methods:h,hooks:G}=a,j=i(i(i({},y),b),h);this[c]=a[c];for(let m of Reflect.ownKeys(j))this[m]=j[m];let{onInit:K,onDestroy:v}=G;K&&K(),v&&l(A).onDestroy(v)}static \u0275fac=function(y){return new(y||s)};static \u0275prov=M({token:s,factory:s.\u0275fac,providedIn:n.providedIn||null})}return s})()}function it(){return{[c]:N({}),stateSignals:{},props:{},methods:{},hooks:{}}}function g(t,...e){let n=typeof t=="function"?[t,...e]:e;return o=>n.reduce((r,s)=>s(r),o)}function rt(t){return e=>{let n=t(i(i(i({[c]:e[c]},e.stateSignals),e.props),e.methods));return Reflect.ownKeys(n),f(i({},e),{props:i(i({},e.props),n)})}}function S(t){return rt(t)}function W(t){return e=>{let n=i(i(i({[c]:e[c]},e.stateSignals),e.props),e.methods),o=typeof t=="function"?t(n):t,r=s=>{let u=o[s],a=e.hooks[s];return u?()=>{a&&a(),u(n)}:a};return f(i({},e),{hooks:{onInit:r("onInit"),onDestroy:r("onDestroy")}})}}function O(t){return e=>{let n=t(i(i(i({[c]:e[c]},e.stateSignals),e.props),e.methods));return Reflect.ownKeys(n),f(i({},e),{methods:i(i({},e.methods),n)})}}function E(t){return e=>{let n=typeof t=="function"?t():t,o=Reflect.ownKeys(n);e[c].update(s=>i(i({},s),n));let r=o.reduce((s,u)=>{let a=d(()=>e[c]()[u]);return f(i({},s),{[u]:P(a)})},{});return f(i({},e),{stateSignals:i(i({},e.stateSignals),r)})}}var p=function(t){return t[t.None=0]="None",t[t.Entities=1]="Entities",t[t.Both=2]="Both",t}(p||{}),st=t=>t.id;function ct(t){return t?.selectId??st}function $(t){let e=t?.collection,n=e===void 0?"entityMap":`${e}EntityMap`,o=e===void 0?"ids":`${e}Ids`,r=e===void 0?"entities":`${e}Entities`;return{entityMapKey:n,idsKey:o,entitiesKey:r}}function ut(t,e){return{entityMap:i({},t[e.entityMapKey]),ids:[...t[e.idsKey]]}}function at(t,e,n){switch(n){case p.Both:return{[e.entityMapKey]:t.entityMap,[e.idsKey]:t.ids};case p.Entities:return{[e.entityMapKey]:t.entityMap};default:return{}}}function dt(t,e,n,o=!1){let r=n(e);return t.entityMap[r]?p.None:(t.entityMap[r]=e,o?t.ids.unshift(r):t.ids.push(r),p.Both)}function ft(t,e,n,o=!1){let r=p.None;for(let s of e){let u=dt(t,s,n,o);u===p.Both&&(r=u)}return r}function q(t,e){let n=ct(e),o=$(e);return r=>{let s=ut(r,o),u=ft(s,t,n);return at(s,o,u)}}function H(t){let{entityMapKey:e,idsKey:n,entitiesKey:o}=$(t);return g(E({[e]:{},[n]:[]}),S(r=>({[o]:d(()=>{let s=r[e]();return r[n]().map(a=>s[a])})})))}var U=(()=>{class t{constructor(){}#t=l(B);#e=l(T);getAllContacts(){return this.#t.get(this.#e).pipe(k(n=>n.map(b=>{var h=b,{first_name:o,last_name:r,job_title:s,created_on:u,phone:a}=h,y=x(h,["first_name","last_name","job_title","created_on","phone"]);return f(i({},y),{firstName:o,lastName:r,jobTitle:s,createdOn:u,phone:this.getPhoneNumber(a)})})))}createContact(n){return this.#t.post(this.#e,JSON.stringify(n))}updateContact(n,o){return this.#t.put(`${this.#e}/${n}`,JSON.stringify(o))}deleteContact(n){return this.#t.delete(`${this.#e}/${n}`)}getPhoneNumber(n){let[o,r]=n?.split("x");return{number:(o??"").trim(),extension:(r??"").trim()}}static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275prov=M({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function J(){return{requestStatus:"pending"}}function V(){return{requestStatus:"fulfilled"}}function z(){return g(E({requestStatus:"idle"}),S(({requestStatus:t})=>({isPending:d(()=>t()==="pending"),isFulfilled:d(()=>t()==="fulfilled"),error:d(()=>t()==="error")})))}var L={entity:void 0,collection:"contact",selectId:t=>t.id},qt=F({providedIn:"root"},H(L),z(),O((t,e=l(U))=>({loadAll(){return C(this,null,function*(){I(t,J());let o=yield R(e.getAllContacts());I(t,q(o,L),V())})}})),W({onInit({loadAll:t}){t()}}));export{qt as a};
