import{a as A,b as c,c as B,d as U,e as V,f as G,g as I,h as L,i as $,j as q,k as H}from"./chunk-YLESHHWD.js";import{a as O,c as Z}from"./chunk-2CNKRT3P.js";import{d as j,h as R}from"./chunk-TWFJH37H.js";import{Ca as u,Db as x,Eb as M,Fa as _,M as v,Ma as S,Oa as D,Qa as b,V as l,Xa as d,_a as g,a as C,aa as E,ba as F,cb as e,db as i,eb as s,gb as T,hb as f,kb as a,na as w,oa as N,rb as k,zb as z}from"./chunk-A2SZTEUK.js";var P=(()=>{class t{constructor(){this.formControl=l(B),this.elementRef=l(N),this.renderer=l(_),this.changeDetectorRef=l(z),this.statusChangesSub=null,this.customMessages="",this.defaultMessages={required:"This field is required.",email:"Invalid email address.",minlength:"Too short.",maxlength:"Too long.",pattern:"Invalid format."},this.formControlElement=this.elementRef.nativeElement,this.errorEl=this.renderer.createElement("small")}onBlur(){this.updateErrorDisplay(this.formControl)}ngOnInit(){this.statusChangesSub=this.formControl.statusChanges?.pipe(v(()=>this.updateErrorDisplay(this.formControl))).subscribe()??null,this.updateErrorDisplay(this.formControl)}updateErrorDisplay(r){let o=this.elementRef.nativeElement.parentElement;if(r.invalid&&r.touched){let n=Object.keys(r.errors??{})[0],p=this.customMessages?this.customMessages[n]:this.defaultMessages[n]??"Invalid field";this.errorEl.textContent=p,this.renderer.addClass(this.errorEl,"text-red-500"),this.renderer.addClass(this.formControlElement,"border-red-300"),o.contains(this.errorEl)||this.renderer.appendChild(o,this.errorEl)}else o.contains(this.errorEl)&&(this.renderer.removeChild(o,this.errorEl),this.renderer.removeClass(this.formControlElement,"border-red-300"));this.changeDetectorRef.detectChanges()}ngOnDestroy(){this.statusChangesSub?.unsubscribe()}static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275dir=D({type:t,selectors:[["","caFormFieldError",""]],hostBindings:function(o,n){o&1&&f("blur",function(m){return n.onBlur(m)})},inputs:{customMessages:[0,"caFormFieldError","customMessages"]}})}}return t})();function K(t,h){t&1&&a(0," Create ")}function Q(t,h){t&1&&a(0," Update ")}function W(t,h){t&1&&a(0," Create ")}function X(t,h){t&1&&a(0," Update ")}var ge=(()=>{class t{#e;#t;#r;constructor(){this.#e=l(Z),this.#t=l(q),this.#r=l(R),this.id=w(null),this.selectedContact=x(()=>{let r=this.id();return r?this.#e.contactEntityMap()[r]:null}),this.contactForm=this.#t.group({firstName:["",[c.required,c.minLength(3)]],lastName:[""],phone:this.#t.group({number:["",[c.required,c.pattern(/^(?:1[-\s]?)?(?:\(\d{3}\)|\d{3})[-.\s]?\d{3}[-.\s]?\d{4}$/)]],extension:["",[c.maxLength(5),c.pattern(/^\d{0,5}$/)]]}),email:["",[c.pattern(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/)]],company:[""],jobTitle:[""],avatar:["",[c.pattern(/^(https?:\/\/)?(www\.)?[\w\-]+(\.[\w\-]+)+(:\d+)?(\/[^\s]*)?(\?[^\s]*)?(#[^\s]*)?$/)]]}),this.contactName=x(()=>`${this.contactForm.get("firstName")?.value??""} ${this.contactForm.get("lastName")?.value??""}`.trim()),M(()=>{let r=this.selectedContact();r&&this.contactForm.patchValue(C({},r))})}submit(){let r=this.id();if(this.contactForm.invalid){this.contactForm.markAllAsTouched();return}let o={id:r,firstName:this.contactForm.get("firstName").value.trim(),lastName:this.contactForm.get("lastName")?.value?.trim()??"",phone:{number:this.contactForm.get("phone.number").value.trim(),extension:this.contactForm.get("phone.extension")?.value?.trim()??""},email:this.contactForm.get("email")?.value?.trim()??"",company:this.contactForm.get("company")?.value?.trim()??"",jobTitle:this.contactForm.get("jobTitle")?.value?.trim()??"",avatar:this.contactForm.get("avatar")?.value?.trim()??""};(r?this.#e.optimisticUpdate(r,o):this.#e.create(o)).then(()=>{this.contactForm.reset(),this.#r.navigate(["/contacts"])})}static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275cmp=S({type:t,selectors:[["ca-create-edit-contact"]],inputs:{id:[1,"id"]},decls:48,vars:6,consts:[[1,"w-auto","flex","flex-col","gap-8","justify-center","bg-white","p-8",3,"formGroup"],[1,"grid","md:grid-cols-2","md:gap-6"],[1,"relative","z-0","w-full","mb-5","group"],["caFormFieldError","","formControlName","firstName","type","text","name","firstName","id","firstName",1,"block","py-2.5","px-0","w-full","text-sm","text-gray-900","bg-transparent","border-0","border-b-2","border-gray-300","appearance-none","focus:outline-none","focus:ring-0","focus:border-blue-600","peer"],["for","firstName",1,"peer-focus:font-medium","absolute","text-sm","text-gray-500","duration-300","transform","-translate-y-6","scale-75","top-3","-z-10","origin-[0]","peer-focus:start-0","rtl:peer-focus:translate-x-1/4","peer-focus:text-blue-600","peer-placeholder-shown:scale-100","peer-placeholder-shown:translate-y-0","peer-focus:scale-75","peer-focus:-translate-y-6"],["caFormFieldError","","formControlName","lastName","type","text","name","lastName","id","lastName",1,"block","py-2.5","px-0","w-full","text-sm","text-gray-900","bg-transparent","border-0","border-b-2","border-gray-300","appearance-none","focus:outline-none","focus:ring-0","focus:border-blue-600","peer"],["for","lastName",1,"peer-focus:font-medium","absolute","text-sm","text-gray-500","duration-300","transform","-translate-y-6","scale-75","top-3","-z-10","origin-[0]","peer-focus:start-0","rtl:peer-focus:translate-x-1/4","peer-focus:text-blue-600","peer-placeholder-shown:scale-100","peer-placeholder-shown:translate-y-0","peer-focus:scale-75","peer-focus:-translate-y-6"],["formGroupName","phone",1,"grid","md:grid-cols-2","md:gap-6"],["caFormFieldError","","formControlName","number","type","text","name","number","id","number",1,"block","py-2.5","px-0","w-full","text-sm","text-gray-900","bg-transparent","border-0","border-b-2","border-gray-300","appearance-none","focus:outline-none","focus:ring-0","focus:border-blue-600","peer"],["for","number",1,"peer-focus:font-medium","absolute","text-sm","text-gray-500","duration-300","transform","-translate-y-6","scale-75","top-3","-z-10","origin-[0]","peer-focus:start-0","rtl:peer-focus:translate-x-1/4","peer-focus:text-blue-600","peer-placeholder-shown:scale-100","peer-placeholder-shown:translate-y-0","peer-focus:scale-75","peer-focus:-translate-y-6"],["caFormFieldError","","formControlName","extension","type","text","name","extension","id","extension",1,"block","py-2.5","px-0","w-full","text-sm","text-gray-900","bg-transparent","border-0","border-b-2","border-gray-300","appearance-none","focus:outline-none","focus:ring-0","focus:border-blue-600","peer"],["for","extension",1,"peer-focus:font-medium","absolute","text-sm","text-gray-500","duration-300","transform","-translate-y-6","scale-75","top-3","-z-10","origin-[0]","peer-focus:start-0","rtl:peer-focus:translate-x-1/4","peer-focus:text-blue-600","peer-placeholder-shown:scale-100","peer-placeholder-shown:translate-y-0","peer-focus:scale-75","peer-focus:-translate-y-6"],[1,"grid","md:grid-cols-3","md:gap-6"],["caFormFieldError","","formControlName","email","type","email","name","email","id","email",1,"block","py-2.5","px-0","w-full","text-sm","text-gray-900","bg-transparent","border-0","border-b-2","border-gray-300","appearance-none","focus:outline-none","focus:ring-0","focus:border-blue-600","peer"],["for","email",1,"peer-focus:font-medium","absolute","text-sm","text-gray-500","duration-300","transform","-translate-y-6","scale-75","top-3","-z-10","origin-[0]","peer-focus:start-0","rtl:peer-focus:translate-x-1/4","rtl:peer-focus:left-auto","peer-focus:text-blue-600","peer-placeholder-shown:scale-100","peer-placeholder-shown:translate-y-0","peer-focus:scale-75","peer-focus:-translate-y-6"],["caFormFieldError","","formControlName","company","type","text","name","company","id","company",1,"block","py-2.5","px-0","w-full","text-sm","text-gray-900","bg-transparent","border-0","border-b-2","border-gray-300","appearance-none","focus:outline-none","focus:ring-0","focus:border-blue-600","peer"],["for","company",1,"peer-focus:font-medium","absolute","text-sm","text-gray-500","duration-300","transform","-translate-y-6","scale-75","top-3","-z-10","origin-[0]","peer-focus:start-0","rtl:peer-focus:translate-x-1/4","peer-focus:text-blue-600","peer-placeholder-shown:scale-100","peer-placeholder-shown:translate-y-0","peer-focus:scale-75","peer-focus:-translate-y-6"],["caFormFieldError","","formControlName","jobTitle","type","text","name","jobTitle","id","jobTitle",1,"block","py-2.5","px-0","w-full","text-sm","text-gray-900","bg-transparent","border-0","border-b-2","border-gray-300","appearance-none","focus:outline-none","focus:ring-0","focus:border-blue-600","peer"],["for","jobTitle",1,"peer-focus:font-medium","absolute","text-sm","text-gray-500","duration-300","transform","-translate-y-6","scale-75","top-3","-z-10","origin-[0]","peer-focus:start-0","rtl:peer-focus:translate-x-1/4","peer-focus:text-blue-600","peer-placeholder-shown:scale-100","peer-placeholder-shown:translate-y-0","peer-focus:scale-75","peer-focus:-translate-y-6"],["caFormFieldError","","formControlName","avatar","type","text","name","avatar","id","avatar",1,"block","py-2.5","px-0","w-full","text-sm","text-gray-900","bg-transparent","border-0","border-b-2","border-gray-300","appearance-none","focus:outline-none","focus:ring-0","focus:border-blue-600","peer"],["for","avatar",1,"peer-focus:font-medium","absolute","text-sm","text-gray-500","duration-300","transform","-translate-y-6","scale-75","top-3","-z-10","origin-[0]","peer-focus:start-0","rtl:peer-focus:translate-x-1/4","peer-focus:text-blue-600","peer-placeholder-shown:scale-100","peer-placeholder-shown:translate-y-0","peer-focus:scale-75","peer-focus:-translate-y-6"],[3,"name","imageUrl"],[1,"flex","flex-row-reverse","gap-6"],[1,"text-white","bg-blue-700","hover:bg-blue-800","focus:ring-4","focus:ring-blue-300","font-medium","rounded-lg","text-sm","px-5","py-2.5","me-2","mb-2","disabled:bg-blue-200","focus:outline-none",3,"click","disabled"]],template:function(o,n){if(o&1){let p=T();k(0),e(1,"form",0)(2,"h2"),b(3,K,1,0)(4,Q,1,0),a(5," Contact"),i(),e(6,"div",1)(7,"div",2),s(8,"input",3),e(9,"label",4),a(10,"First name"),i()(),e(11,"div",2),s(12,"input",5),e(13,"label",6),a(14,"Last name"),i()()(),e(15,"div",7)(16,"div",2),s(17,"input",8),e(18,"label",9),a(19,"Phone"),i()(),e(20,"div",2),s(21,"input",10),e(22,"label",11),a(23,"Extension"),i()()(),e(24,"div",12)(25,"div",2),s(26,"input",13),e(27,"label",14),a(28,"Email"),i()(),e(29,"div",2),s(30,"input",15),e(31,"label",16),a(32,"Company"),i()(),e(33,"div",2),s(34,"input",17),e(35,"label",18),a(36,"Job title"),i()()(),e(37,"div",1)(38,"div",2),s(39,"input",19),e(40,"label",20),a(41,"Profile image URL"),i()(),e(42,"div",2),s(43,"ca-avatar",21),i()(),e(44,"div",22)(45,"button",23),f("click",function(){return E(p),F(n.submit())}),b(46,W,1,0)(47,X,1,0),i()()()}if(o&2){let p,m,y=n.selectedContact();u(),d("formGroup",n.contactForm),u(2),g(y?4:3),u(40),d("name",(p=n.selectedContact())==null?null:p.firstName)("imageUrl",(m=(m=n.contactForm.get("avatar"))==null?null:m.value)!==null&&m!==void 0?m:""),u(2),d("disabled",!n.contactForm.valid),u(),g(y?47:46)}},dependencies:[j,H,G,A,U,V,I,$,L,P,O],encapsulation:2})}}return t})();export{ge as CreateEditContactComponent};
