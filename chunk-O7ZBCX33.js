import{b as H,d as R,g as P,h as M,i as j}from"./chunk-M2FXLXZE.js";import{f as D}from"./chunk-OJG2KOKQ.js";import{a as q}from"./chunk-KZOAHJRE.js";import{Ha as S,La as x,Ra as u,Ua as w,V as d,Ya as h,Za as C,_a as y,aa as r,ab as _,ba as a,bb as f,cb as s,d as b,gb as L,kb as v,lb as O,mb as V,nb as T,ob as k,pa as p,pb as N,ya as g,yb as m}from"./chunk-ANTMNTRI.js";var z=(o,c)=>{let e=[];for(let i=0;i<o.length;i++){let t=c(o[i],i);t!==void 0&&e.push(t)}return e},A=(o,c,e="asc")=>o.slice().sort((i,t)=>{let n=String(i[c]).toLowerCase(),l=String(t[c]).toLowerCase();return n<l?e==="asc"?-1:1:n>l?e==="asc"?1:-1:0});function B(o,c){if(o&1){let e=_();h(0,"ca-table",4),V("searchStringChange",function(t){r(e);let n=s();return O(n.searchString,t)||(n.searchString=t),a(t)}),f("rowClick",function(t){r(e);let n=s();return a(n.onRowClick(t))})("pageChange",function(t){r(e);let n=s();return a(n.onPageChange(t))})("searchChange",function(t){r(e);let n=s();return a(n.onSearchChange(t))})("sortChange",function(t){r(e);let n=s();return a(n.onSortChange(t))})("delete",function(t){r(e);let n=s();return a(n.onDelete(t))})("update",function(t){r(e);let n=s();return a(n.onUpdate(t))}),C()}if(o&2){let e=s(),i=N(0);u("key","id")("fields",e.columns())("values",i)("totalRecords",e.filteredContactList().length)("paginationOptions",e.paginationOptions())("sortOption",e.sortOption()),v("searchString",e.searchString)}}var ee=(()=>{class o{#t;#e;#i;#o;#r;constructor(){this.#t=d(q),this.#e=d(R),this.#i=d(H),this.#o=d(j),this.columns=p([{id:"id",name:"Id",type:"string",isHidden:!0,isSortable:!1},{id:"name",name:"Name",type:"string",isHidden:!1,isSortable:!0},{id:"company",name:"Company",type:"string",isHidden:!1,isSortable:!1},{id:"phone",name:"Phone",type:"string",isHidden:!1,isSortable:!1},{id:"email",name:"email",type:"string",isHidden:!1,isSortable:!0},{id:"jobTitle",name:"Job title",type:"string",isHidden:!1,isSortable:!1},{id:"createdOn",name:"Created On",type:"date",isHidden:!0,isSortable:!1}]),this.loadingStatus=this.#t.requestStatus,this.searchString=p(""),this.paginationOptions=p({pageNumber:1,pageSize:10}),this.sortOption=p({field:"name",order:"asc"}),this.filteredContactList=m(()=>{let e=this.#t.contactEntities(),i=this.searchString().toLowerCase().trim();return z(e,t=>{let n=[t.firstName,t.lastName,t.email];return!i||n.some(l=>l?.toLowerCase().includes(i))?{id:t.id,company:t.company??"",jobTitle:t.jobTitle??"",name:`${t.firstName} ${t.lastName??""}`,phone:t.phone.extension?`${t.phone.number} x${t.phone.extension}`:t.phone.number,email:t.email}:void 0})}),this.#r=m(()=>{let e=this.sortOption();return A(this.filteredContactList(),e.field,e.order)}),this.paginatedContacts=m(()=>{let{pageNumber:e,pageSize:i}=this.paginationOptions();return this.#r().slice((e-1)*i,e*i)}),this.#i.queryParamMap.subscribe(e=>{let i=e.get("pn")??1,t=e.get("ps")??10,n=e.get("so");this.paginationOptions.set({pageNumber:Number(i),pageSize:Number(t)}),this.sortOption.update(l=>({field:e.get("sb")??l.field,order:n??l.order})),this.searchString.set(e.get("ss")??"")})}createContact(){this.#e.navigate(["/","new"])}onRowClick(e){this.#e.navigate(["/","contacts",e.data.id])}onUpdate(e){this.#e.navigate(["/","edit",e.data.id])}onPageChange(e){this.#n({pn:e})}onSearchChange(e){this.#n({ss:e?.trim()})}onSortChange(e){this.#n({sb:e.field,so:e.order})}onDelete(e){return b(this,null,function*(){(yield this.#o.confirm("Are you sure you want to delete this contact?",e.data.name))&&console.log("Deleting...")})}#n(e){this.#e.navigate([],{relativeTo:this.#i,queryParams:e,queryParamsHandling:"merge"})}static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275cmp=S({type:o,selectors:[["ca-contact-list"]],hostAttrs:[1,"flex","flex-col","gap-4","h-full"],decls:6,vars:3,consts:[[1,"flex","flex-row-reverse"],[1,"text-white","bg-blue-700","hover:bg-blue-800","focus:ring-4","focus:ring-blue-300","font-medium","rounded-lg","text-sm","px-5","py-2.5","me-2","mb-2","dark:bg-blue-600","dark:hover:bg-blue-700","focus:outline-none","dark:focus:ring-blue-800",3,"click"],[3,"key","fields","values","totalRecords","paginationOptions","sortOption","searchString"],[3,"requestStatus"],[3,"searchStringChange","rowClick","pageChange","searchChange","sortChange","delete","update","key","fields","values","totalRecords","paginationOptions","sortOption","searchString"]],template:function(i,t){if(i&1){let n=_();T(0),h(1,"div",0)(2,"button",1),f("click",function(){return r(n),a(t.createContact())}),L(3," Create new "),C()(),x(4,B,1,7,"ca-table",2),y(5,"ca-loading-indicator",3)}i&2&&(k(t.paginatedContacts()),g(4),w(t.loadingStatus()==="fulfilled"?4:-1),g(),u("requestStatus",t.loadingStatus()))},dependencies:[D,M,P],encapsulation:2,changeDetection:0})}}return o})();export{ee as ContactListComponent};
