import{Aa as H,Ca as L,Cb as _,Db as l,Eb as N,Lb as ot,Ma as J,P as b,Qa as G,S as $,V as m,Xa as Q,Za as X,_a as Y,a as s,b as h,c as S,cb as Z,db as tt,eb as et,ha as z,ib as T,kb as nt,lb as it,na as C,pa as V,q as w,qa as K,r as E}from"./chunk-A2SZTEUK.js";function vt(t,e){if(t&1&&et(0,"img",0),t&2){let i=T();Q("src",i.imageUrl(),H)}}function xt(t,e){if(t&1&&(Z(0,"div")(1,"span",2),nt(2),tt()()),t&2){let i=T();X("relative inline-flex items-center justify-center ",i.size()," overflow-hidden bg-gray-100 rounded-full"),L(2),it(i.initials())}}var Wt=(()=>{class t{constructor(){this.name=C(),this.imageUrl=C(),this.size=C("sm"),this.isValidImage=K(!1),this.initials=l(()=>this.name()?.split(" ").reduce((i,n)=>(i??"").concat(n.charAt(0)),"")),N(()=>{let i=this.imageUrl();if(!i){this.isValidImage.set(!1);return}let n=new Image;n.onload=()=>this.isValidImage.set(!0),n.onerror=()=>this.isValidImage.set(!1),n.src=i})}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=J({type:t,selectors:[["ca-avatar"]],inputs:{name:[1,"name"],imageUrl:[1,"imageUrl"],size:[1,"size"]},decls:2,vars:1,consts:[["alt","name()",1,"size()","rounded-full",3,"src"],[3,"class"],[1,"font-medium","text-gray-600"]],template:function(n,o){n&1&&G(0,vt,1,1,"img",0)(1,xt,3,4,"div",1),n&2&&Y(o.isValidImage()?0:1)},encapsulation:2})}}return t})();function st(t){let e=_(()=>t());return bt(e)?new Proxy(t,{get(i,n){return n in e?(V(i[n])||Object.defineProperty(i,n,{value:l(()=>i()[n]),configurable:!0}),st(i[n])):i[n]}}):t}var jt=[WeakSet,WeakMap,Promise,Date,Error,RegExp,ArrayBuffer,DataView,Function];function bt(t){if(t===null||typeof t!="object"||Ct(t))return!1;let e=Object.getPrototypeOf(t);if(e===Object.prototype)return!0;for(;e&&e!==Object.prototype;){if(jt.includes(e.constructor))return!1;e=Object.getPrototypeOf(e)}return e===Object.prototype}function Ct(t){return typeof t?.[Symbol.iterator]=="function"}var Kt=new WeakMap,d=Symbol("STATE_SOURCE");function f(t,...e){t[d].update(i=>e.reduce((n,o)=>s(s({},n),typeof o=="function"?o(n):o),i)),kt(t)}function At(t){return t[d]()}function Rt(t){return Kt.get(t[d])||[]}function kt(t){let e=Rt(t);for(let i of e){let n=_(()=>At(t));i(n)}}function ct(...t){let e=[...t],i=typeof e[0]=="function"?{}:e.shift(),n=e;return(()=>{class r{constructor(){let a=n.reduce((j,It)=>It(j),Ut()),{stateSignals:y,props:D,methods:M,hooks:Et}=a,P=s(s(s({},y),D),M);this[d]=a[d];for(let j of Reflect.ownKeys(P))this[j]=P[j];let{onInit:q,onDestroy:W}=Et;q&&q(),W&&m(z).onDestroy(W)}static \u0275fac=function(y){return new(y||r)};static \u0275prov=b({token:r,factory:r.\u0275fac,providedIn:i.providedIn||null})}return r})()}function Ut(){return{[d]:K({}),stateSignals:{},props:{},methods:{},hooks:{}}}function A(t,...e){let i=typeof t=="function"?[t,...e]:e;return n=>i.reduce((o,r)=>r(o),n)}function Dt(t){return e=>{let i=t(s(s(s({[d]:e[d]},e.stateSignals),e.props),e.methods));return Reflect.ownKeys(i),h(s({},e),{props:s(s({},e.props),i)})}}function R(t){return Dt(t)}function at(t){return e=>{let i=s(s(s({[d]:e[d]},e.stateSignals),e.props),e.methods),n=typeof t=="function"?t(i):t,o=r=>{let c=n[r],a=e.hooks[r];return c?()=>{a&&a(),c(i)}:a};return h(s({},e),{hooks:{onInit:o("onInit"),onDestroy:o("onDestroy")}})}}function ut(t){return e=>{let i=t(s(s(s({[d]:e[d]},e.stateSignals),e.props),e.methods));return Reflect.ownKeys(i),h(s({},e),{methods:s(s({},e.methods),i)})}}function k(t){return e=>{let i=typeof t=="function"?t():t,n=Reflect.ownKeys(i);e[d].update(r=>s(s({},r),i));let o=n.reduce((r,c)=>{let a=l(()=>e[d]()[c]);return h(s({},r),{[c]:st(a)})},{});return h(s({},e),{stateSignals:s(s({},e.stateSignals),o)})}}var u=function(t){return t[t.None=0]="None",t[t.Entities=1]="Entities",t[t.Both=2]="Both",t}(u||{}),Tt=t=>t.id;function U(t){return t?.selectId??Tt}function g(t){let e=t?.collection,i=e===void 0?"entityMap":`${e}EntityMap`,n=e===void 0?"ids":`${e}Ids`,o=e===void 0?"entities":`${e}Entities`;return{entityMapKey:i,idsKey:n,entitiesKey:o}}function I(t,e){return{entityMap:s({},t[e.entityMapKey]),ids:[...t[e.idsKey]]}}function v(t,e,i){switch(i){case u.Both:return{[e.entityMapKey]:t.entityMap,[e.idsKey]:t.ids};case u.Entities:return{[e.entityMapKey]:t.entityMap};default:return{}}}function dt(t,e,i,n=!1){let o=i(e);return t.entityMap[o]?u.None:(t.entityMap[o]=e,n?t.ids.unshift(o):t.ids.push(o),u.Both)}function _t(t,e,i,n=!1){let o=u.None;for(let r of e){let c=dt(t,r,i,n);c===u.Both&&(o=c)}return o}function Nt(t,e,i,n=!0){let o=i(e);return t.entityMap[o]?(t.entityMap[o]=n?e:s(s({},t.entityMap[o]),e),u.Entities):(t.entityMap[o]=e,t.ids.push(o),u.Both)}function Ft(t,e){let i=Array.isArray(e)?e:t.ids.filter(o=>e(t.entityMap[o])),n=u.None;for(let o of i)t.entityMap[o]&&(delete t.entityMap[o],n=u.Both);return n===u.Both&&(t.ids=t.ids.filter(o=>o in t.entityMap)),n}function Ot(t,e,i,n){let o=Array.isArray(e)?e:t.ids.filter(a=>e(t.entityMap[a])),r,c=u.None;for(let a of o){let y=t.entityMap[a];if(y){let D=typeof i=="function"?i(y):i;t.entityMap[a]=s(s({},y),D),c=u.Entities;let M=n(t.entityMap[a]);M!==a&&(t.entityMap[M]=t.entityMap[a],delete t.entityMap[a],r=r||{},r[a]=M)}}return r&&(t.ids=t.ids.map(a=>r[a]??a),c=u.Both),c}function F(t,e){let i=U(e),n=g(e);return o=>{let r=I(o,n),c=dt(r,t,i);return v(r,n,c)}}function lt(t,e){let i=U(e),n=g(e);return o=>{let r=I(o,n),c=_t(r,t,i);return v(r,n,c)}}function ft(t,e){let i=g(e);return n=>{let o=I(n,i),r=Ft(o,[t]);return v(o,i,r)}}function pt(t,e){let i=U(e),n=g(e);return o=>{let r=I(o,n),c=Ot(r,[t.id],t.changes,i);return v(r,n,c)}}function O(t,e){let i=U(e),n=g(e);return o=>{let r=I(o,n),c=Nt(r,t,i,!1);return v(r,n,c)}}function yt(t){let{entityMapKey:e,idsKey:i,entitiesKey:n}=g(t);return A(k({[e]:{},[i]:[]}),R(o=>({[n]:l(()=>{let r=o[e]();return o[i]().map(a=>r[a])})})))}var mt=new $("API URL");var x=t=>({id:t.id,firstName:t.first_name,lastName:t.last_name,email:t.email,company:t.company,jobTitle:t.job_title,createdOn:t.created_on,phone:Bt(t.phone),avatar:t.avatar}),ht=t=>({id:t.id,first_name:t.firstName,last_name:t.lastName,email:t.email,company:t.company,job_title:t.jobTitle,created_on:t.createdOn,phone:`${t.phone.number}${t.phone.extension?" x"+t.phone.extension:""}`,avatar:t.avatar}),Bt=t=>{let[e,i]=t?.split("x");return{number:(e??"").trim(),extension:(i??"").trim()}};var gt=(()=>{class t{#t=m(ot);#e=m(mt);getAllContacts(){return this.#t.get(this.#e).pipe(E(i=>i.map(n=>x(n))))}deleteContact(i){return this.#t.delete(`${this.#e}/${i}`).pipe(E(n=>x(n)))}createOrUpdateContact(i){let n=ht(i);return i.id?this.#i(i.id,n):this.#n(n)}#n(i){return this.#t.post(this.#e,JSON.stringify(i)).pipe(E(n=>x(n)))}#i(i,n){return this.#t.put(`${this.#e}/${i}`,JSON.stringify(n)).pipe(E(o=>x(o)))}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275prov=b({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function Mt(){return{requestStatus:"pending"}}function St(){return{requestStatus:"fulfilled"}}function B(t){return{requestStatus:{error:t}}}function wt(){return A(k({requestStatus:"idle"}),R(({requestStatus:t})=>({isPending:l(()=>t()==="pending"),isFulfilled:l(()=>t()==="fulfilled"),error:l(()=>{let e=t();return typeof e=="object"?e.error:null})})))}var p={entity:void 0,collection:"contact",selectId:t=>t.id},Ee=ct({providedIn:"root"},yt(p),wt(),ut((t,e=m(gt))=>({loadAll(){return S(this,null,function*(){f(t,Mt());let n=yield w(e.getAllContacts());f(t,lt(n,p),St())})},create(n){return S(this,null,function*(){if(!n)throw new Error("Contact is required");try{let o=yield w(e.createOrUpdateContact(n));f(t,F(o,p))}catch(o){throw f(t,B("Failed to create contact")),o}})},optimisticUpdate(n,o){return S(this,null,function*(){if(!o||!n)throw new Error("Contact is required");let r=t.contactEntityMap()[n];f(t,O(o,p));try{let c=yield w(e.createOrUpdateContact(o));f(t,O(c,p))}catch(c){throw f(t,pt({id:n,changes:r},p),B("Failed to update contact")),c}})},optimisticDelete(n){return S(this,null,function*(){if(!n)throw new Error("Contact ID is required");let o=t.contactEntityMap()[n];f(t,ft(n,p));try{yield w(e.deleteContact(n))}catch(r){throw f(t,F(o,p)),r}})}})),at({onInit({loadAll:t}){t()}}));export{Wt as a,mt as b,Ee as c};
