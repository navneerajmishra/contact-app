import{b as H,d as R,g as P,h as M,i as j}from"./chunk-JO57LDTW.js";import{e as D}from"./chunk-R6EJAAEB.js";import{a as q}from"./chunk-M6OAQ2DG.js";import{$a as _,Fa as b,Ja as w,Oa as C,Ra as x,V as d,Va as u,Wa as h,Xa as y,aa as a,ab as f,ba as r,bb as s,d as S,fb as L,jb as v,kb as O,lb as V,mb as T,na as p,nb as k,ob as N,wa as g,wb as m}from"./chunk-PLQDF3RK.js";var z=(o,l)=>{let e=[];for(let i=0;i<o.length;i++){let t=l(o[i],i);t!==void 0&&e.push(t)}return e},B=(o,l,e="asc")=>o.slice().sort((i,t)=>{let n=String(i[l]).toLowerCase(),c=String(t[l]).toLowerCase();return n<c?e==="asc"?-1:1:n>c?e==="asc"?1:-1:0});function A(o,l){if(o&1){let e=_();u(0,"ca-table",3),V("searchStringChange",function(t){a(e);let n=s();return O(n.searchString,t)||(n.searchString=t),r(t)}),f("rowClick",function(t){a(e);let n=s();return r(n.onRowClick(t))})("pageChange",function(t){a(e);let n=s();return r(n.onPageChange(t))})("searchChange",function(t){a(e);let n=s();return r(n.onSearchChange(t))})("sortChange",function(t){a(e);let n=s();return r(n.onSortChange(t))})("delete",function(t){a(e);let n=s();return r(n.onDelete(t))})("update",function(t){a(e);let n=s();return r(n.onUpdate(t))}),h()}if(o&2){let e=s(),i=N(0);C("key","id")("fields",e.columns())("values",i)("totalRecords",e.filteredContactList().length)("paginationOptions",e.paginationOptions())("sortOption",e.sortOption()),v("searchString",e.searchString)}}var ee=(()=>{class o{#t;#e;#i;#o;#a;constructor(){this.#t=d(q),this.#e=d(R),this.#i=d(H),this.#o=d(j),this.columns=p([{id:"id",name:"Id",type:"string",isHidden:!0,isSortable:!1},{id:"name",name:"Name",type:"string",isHidden:!1,isSortable:!0},{id:"company",name:"Company",type:"string",isHidden:!1,isSortable:!1},{id:"phone",name:"Phone",type:"string",isHidden:!1,isSortable:!1},{id:"email",name:"email",type:"string",isHidden:!1,isSortable:!0},{id:"jobTitle",name:"Job title",type:"string",isHidden:!1,isSortable:!1},{id:"createdOn",name:"Created On",type:"date",isHidden:!1,isSortable:!0}]),this.loadingStatus=this.#t.requestStatus,this.searchString=p(""),this.paginationOptions=p({pageNumber:1,pageSize:10}),this.sortOption=p({field:"name",order:"asc"}),this.filteredContactList=m(()=>{let e=this.#t.contactEntities(),i=this.searchString().toLowerCase().trim();return z(e,t=>{let n=[t.firstName,t.lastName,t.email];return!i||n.some(c=>c?.toLowerCase().includes(i))?{id:t.id,company:t.company??"",jobTitle:t.jobTitle??"",name:`${t.firstName} ${t.lastName??""}`,phone:t.phone.extension?`${t.phone.number} x${t.phone.extension}`:t.phone.number,email:t.email}:void 0})}),this.#a=m(()=>{let e=this.sortOption();return B(this.filteredContactList(),e.field,e.order)}),this.paginatedContacts=m(()=>{let{pageNumber:e,pageSize:i}=this.paginationOptions();return this.#a().slice((e-1)*i,e*i)}),this.#i.queryParamMap.subscribe(e=>{let i=e.get("pn")??1,t=e.get("ps")??10,n=e.get("so");this.paginationOptions.set({pageNumber:Number(i),pageSize:Number(t)}),this.sortOption.update(c=>({field:e.get("sb")??c.field,order:n??c.order})),this.searchString.set(e.get("ss")??"")})}createContact(){this.#e.navigate(["/","new"])}onRowClick(e){this.#e.navigate(["/","contacts",e.data.id])}onUpdate(e){this.#e.navigate(["/","edit",e.data.id])}onPageChange(e){this.#n({pn:e})}onSearchChange(e){this.#n({ss:e?.trim()})}onSortChange(e){this.#n({sb:e.field,so:e.order})}onDelete(e){return S(this,null,function*(){(yield this.#o.confirm(`Delete ${e.data.name}`,"Are you sure you want to delete this contact?"))&&console.log("Deleting...")})}#n(e){this.#e.navigate([],{relativeTo:this.#i,queryParams:e,queryParamsHandling:"merge"})}static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275cmp=b({type:o,selectors:[["ca-contact-list"]],decls:5,vars:3,consts:[[3,"click"],[3,"key","fields","values","totalRecords","paginationOptions","sortOption","searchString"],[3,"requestStatus"],[3,"searchStringChange","rowClick","pageChange","searchChange","sortChange","delete","update","key","fields","values","totalRecords","paginationOptions","sortOption","searchString"]],template:function(i,t){if(i&1){let n=_();T(0),u(1,"button",0),f("click",function(){return a(n),r(t.createContact())}),L(2,"Create new"),h(),w(3,A,1,7,"ca-table",1),y(4,"ca-loading-indicator",2)}i&2&&(k(t.paginatedContacts()),g(3),x(t.loadingStatus()==="fulfilled"?3:-1),g(),C("requestStatus",t.loadingStatus()))},dependencies:[D,M,P],encapsulation:2,changeDetection:0})}}return o})();export{ee as ContactListComponent};
